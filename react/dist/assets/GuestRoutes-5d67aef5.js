import{f as L,r as o,e as v,a as s,j as e,L as R,o as P,N as E,S as T,m as U,F as k,n as x}from"./index-8e1ee696.js";import{M as A,ae as F,aj as O,ak as V}from"./index-74298ed0.js";function C(){const n=L(),[i,m]=o.useState(!1),u=o.createRef(),a=o.createRef(),{setUser:g,setToken:_}=v(),[p,c]=o.useState(null),[N,d]=o.useState(!1),w=()=>{m(!i)},b=l=>{P.defaults.baseURL=l};return o.useEffect(()=>{document.title="Login",typeof window.__APP_CONFIG__<"u"&&window.__APP_CONFIG__.VITE_APP_BASE_URL?b(`${window.__APP_CONFIG__.VITE_APP_BASE_URL}/api`):console.error("VITE_APP_BASE_URL is not defined. Please check your configuration.")},[]),s("div",{className:"login-signup-form animated fadeInDown",children:[e(A,{loaderVisible:N}),s("div",{className:"form",children:[e("div",{className:"alert alert-info title",children:"Login into your account"}),e("hr",{}),p&&e("div",{className:"form-group alert-box",children:p}),s("form",{onSubmit:async l=>{l.preventDefault(),d(!0);const S={email:u.current.value,password:a.current.value};typeof P.defaults.baseURL<"u"?P.post("/login",S).then(({data:r})=>{g(r.user),_(r.token),localStorage.setItem("ACCESS_USER",JSON.stringify(r.user)),localStorage.setItem("ACCESS_TOKEN",r.token),localStorage.setItem("ACCESS_ROLE",r.user.role_as),localStorage.setItem("CURRENT_COMPANY",r.user.primary_company),d(!1),r.user.role_as==="employee"?n("/employee-dashboard"):n("/dashboard")}).catch(r=>{const t=r.response;t&&t.status===403?(c("Your subscription is not active"),t.data.subscription_status==="renew"&&setSubscriptionStatus(t.data.subscription_status)):t&&t.status===422?c(t.data.message):t&&t.status===404&&c("Attention: The configuration process is incomplete as VITE_APP_BASE_URL is not defined in config.js. Kindly refer to the installation documentation for guidance and ensure that the application is properly configured before proceeding with the login."),d(!1)}):(d(!1),c("Attention: The configuration process is incomplete as VITE_APP_BASE_URL is not defined in config.js. Kindly refer to the installation documentation for guidance and ensure that the application is properly configured before proceeding with the login. Once configured properly make a hard reload of the page."))},children:[s("div",{className:"form-group",children:[e("label",{className:"custom-form-label",htmlFor:"email",children:"Email"}),e("input",{className:"custom-form-control",ref:u,type:"email",placeholder:"Email"})]}),s("div",{className:"form-group",children:[e("label",{className:"custom-form-label",htmlFor:"password",children:"Password"}),s("div",{className:"password-input",children:[e("input",{className:"custom-form-control",ref:a,type:i?"text":"password",placeholder:"Password"}),e(F,{icon:i?O:V,className:"eye-icon",onClick:w})]})]}),e("button",{className:"btn-add btn-block",children:"Login"}),s("p",{className:"message",children:["Not registered? ",e(R,{to:"/signup",children:"Create an account"})]})]})]})]})}function j(){const{token:n}=v();return window.__APP_CONFIG__.VITE_APP_BASE_URL?n?e(E,{to:"/"}):e("div",{children:e(C,{})}):e("div",{className:"login-signup-form animated fadeInDown",children:s("div",{className:"form",children:[e("div",{className:"alert alert-danger title",children:"ATTENTION!"}),e("hr",{}),s("p",{children:["The configuration process is incomplete as VITE_APP_BASE_URL is not defined in config.js. Kindly refer to the installation documentation for guidance and ensure that the application is properly configured before proceeding with the login. Once you put the VITE_APP_BASE_URL in config.js in the base folder, click"," ",e("a",{href:"#",onClick:()=>{window.location.reload(!0)},children:"here"})," ","to perform a hard refresh and redirect to the login page."]})]})})}function B(){const n=o.useRef(),i=o.useRef(),m=o.useRef(),u=o.useRef(),[a,g]=o.useState(null),{setUser:_,setToken:p}=v(),{applicationSettings:c,setUserRole:N}=o.useContext(T),{default_currency:d,registration_type:w,product_price:b}=c,[h,l]=o.useState(!1),S=o.useRef(null);return o.useEffect(()=>{document.title="Signup"},[]),s("div",{className:"login-signup-form animated fadeInDown",children:[e(A,{loaderVisible:h}),h&&e("div",{ref:S,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(255, 255, 255, 0.7)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:999},children:e("div",{className:"loading-spinner"})}),e("div",{className:"form",children:s("form",{onSubmit:async t=>{t.preventDefault(),l(!0);const I={name:n.current.value,email:i.current.value,password:m.current.value,password_confirmation:u.current.value};try{const{data:f}=await U.post("/signup",I);_(f.user),N(f.user_role),p(f.token),l(!1)}catch(f){const y=f.response;y&&y.status===422&&g(y.data.errors)}finally{l(!1)}},action:"",children:[w==="free"?e("div",{className:"alert alert-info title",children:"Signup for free"}):s("div",{className:"alert alert-warning title",children:["Subscribe for ",d+b," / Month"]}),e("hr",{}),s("div",{className:"form-group",children:[e("label",{className:"custom-form-label",htmlFor:"full_name",children:"Full Name"}),e("input",{className:"custom-form-control",ref:n,type:"text",placeholder:"Full Name"}),a&&a.name&&e("p",{className:"error-message mt-2",children:a.name[0]})]}),s("div",{className:"form-group",children:[e("label",{className:"custom-form-label",htmlFor:"email_address",children:"Email"}),e("input",{className:"custom-form-control",ref:i,type:"email",placeholder:"Email Address"}),a&&a.email&&e("p",{className:"error-message mt-2",children:a.email[0]})]}),s("div",{className:"form-group",children:[e("label",{className:"custom-form-label",htmlFor:"password",children:"Password"}),e("input",{className:"custom-form-control",ref:m,type:"password",placeholder:"Password"}),a&&a.password&&e("p",{className:"error-message mt-2",children:a.password[0]})]}),s("div",{className:"form-group",children:[e("label",{className:"custom-form-label",htmlFor:"password_confirmation",children:"Confirm Password"}),e("input",{className:"custom-form-control",ref:u,type:"password",placeholder:"Password Confirmation"}),a&&a.password_confirmation&&e("p",{className:"error-message mt-2",children:a.password_confirmation[0]})]}),e("button",{className:"btn-add btn-block",children:h?"Signing up...":"Sign up"}),s("p",{className:"message",children:["Already registered ? ",e(R,{to:"/login",children:"Sign in"})]})]})})]})}function G(){return e(k,{})}const K=()=>x([{path:"/",element:e(j,{}),children:[{path:"/",element:e(E,{to:"/login",replace:!0})},{path:"/login",element:e(C,{})},{path:"/signup",element:e(B,{})},{path:"/signup/company",element:e(G,{})}]},{path:"*",element:e(E,{to:"/login",replace:!0})}]);export{K as createGuestRouter};
