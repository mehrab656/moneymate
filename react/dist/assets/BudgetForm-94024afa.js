import{r as m,f as E,e as D,af as F,m as d,a as o,F as w,j as a}from"./index-8e1ee696.js";import{S as B}from"./react-select.esm-c00a6ec0.js";import{e as N}from"./index-dc02ab6d.js";import{W as M}from"./WizCard-c3a4d722.js";import{M as y}from"./index-74298ed0.js";import{n as u}from"./AuthRoutes-2e952a6b.js";import"./unsupportedIterableToArray-5ed4c917.js";import"./classCallCheck-25f3f0e0.js";import"./toConsumableArray-46a81798.js";function P(){const[r,T]=m.useState({}),[g,l]=m.useState(!1),p=E(),[_,S]=m.useState([]),[h,f]=m.useState([]),[t,c]=m.useState({id:null,budget_name:"",amount:"",start_date:"",end_date:"",use_id:null});D();let{id:b}=F();const v=()=>{d.get("/expense-categories").then(({data:e})=>{S(e.categories)}).catch(e=>{console.error("Error loading expense categories:",e)})};m.useEffect(()=>{v()},[]),b&&m.useEffect(()=>{l(!0),d.get(`/budgets/${b}`).then(({data:e})=>{l(!1),c(e),f(e.categories.map(i=>({value:i.id,label:i.name})))}).catch(e=>{l(!0),console.warn("Unable to load budget",e)})},[]);const x=e=>{f(e)};m.useEffect(()=>{(t==null?void 0:t.start_date)===""&&c({...t,start_date:new Date().toISOString().split("T")[0]})},[t==null?void 0:t.start_date]);const C=e=>{e.preventDefault(),l(!0);const i={...t,categories:h.map(s=>s.value)};t.id?d.put(`/budgets/${t.id}`,i).then(({data:s})=>{u("success",s==null?void 0:s.message,s==null?void 0:s.description),p("/budgets"),l(!1)}).catch(s=>{if(s.response){const n=s.response.data;u("error",n==null?void 0:n.message,n.description)}l(!1)}):d.post("/budgets",i).then(({data:s})=>{u("success",s==null?void 0:s.message,s==null?void 0:s.description),p("/budgets"),l(!1)}).catch(s=>{if(s.response){const n=s.response.data;u("error",n==null?void 0:n.message,n.description)}l(!1)})};return o(w,{children:[a(y,{loaderVisible:g}),o("div",{className:"d-flex justify-content-between align-content-center gap-2 mb-3",children:[t.id&&o("h1",{className:"title-text mb-0",children:["Update Budget: ",t.budget_name]}),!t.id&&a("h1",{className:"title-text mb-0",children:"Add New Budget"})]}),o(M,{className:"animated fadeInDown wiz-card-mh",children:[g&&a("div",{className:"text-center",children:"Loading..."}),!g&&o("form",{onSubmit:C,children:[o("div",{className:"form-group",children:[a("label",{className:"custom-form-label",htmlFor:"budget_name",children:"Budget Name"}),a("input",{className:`custom-form-control ${r.budget_name?"has-error":""}`,value:t.budget_name,onChange:e=>c({...t,budget_name:e.target.value}),placeholder:"Budget Name"}),r.budget_name&&a("p",{className:"error-message mt-2",children:r.budget_name[0]})]}),o("div",{className:"form-group",children:[a("label",{className:"custom-form-label",htmlFor:"budget_amount",children:"Budget Amount"}),a("input",{className:`custom-form-control ${r.amount?"has-error":""}`,value:t.amount,onChange:e=>c({...t,amount:e.target.value}),placeholder:"Budget Amount"}),r.amount&&a("p",{className:"error-message mt-2",children:r.amount[0]})]}),o("div",{className:"form-group",children:[a("label",{className:"custom-form-label",htmlFor:"expense_categories",children:"Expense Categories"}),a(B,{isMulti:!0,value:h,options:_.map(e=>({value:e.id,label:e.name})),onChange:x}),r.categories&&a("p",{className:"error-message mt-2",children:r.categories[0]})]}),o("div",{className:"form-group",children:[a("label",{className:"custom-form-label",htmlFor:"start_date",children:"Start Date"}),a(N,{className:"custom-form-control",selected:t.start_date?new Date(t.start_date):new Date,onChange:e=>c({...t,start_date:e?e.toISOString().split("T")[0]:""}),dateFormat:"yyyy-MM-dd",placeholderText:"Start Date"}),r.start_date&&a("p",{className:"error-message mt-2",children:r.start_date[0]})]}),o("div",{className:"form-group",children:[a("label",{className:"custom-form-label",htmlFor:"end_date",children:"End Date"}),a(N,{className:"custom-form-control",selected:t.end_date?new Date(t.end_date):null,onChange:e=>c({...t,end_date:e?e.toISOString().split("T")[0]:""}),dateFormat:"yyyy-MM-dd",placeholderText:"End Date"}),r.end_date&&a("p",{className:"error-message mt-2",children:r.end_date[0]})]}),a("button",{className:"custom-btn btn-add",children:"Save"})]})]})]})}export{P as default};
