import{r as o,S as G,ad as H,h as V,a as r,j as e}from"./index-8e1ee696.js";import{M as $,ae as y,ap as z,au as J}from"./index-74298ed0.js";import{C as K,R as C,a as p,e as O,H as U}from"./AuthRoutes-2e952a6b.js";import{E as W,a as X}from"./ExpenseFilter-caaabd92.js";import{R as Y}from"./index-80c335aa.js";import{I as w}from"./InputGroup-ffc38a75.js";import{F as Z}from"./Form-833e738d.js";import"./Modal-bc712426.js";import"./Tab-e8b7d17a.js";import"./CardHeaderContext-cb83d0a9.js";const f={start_date:"",end_date:"",categoryIDS:[],sectorIDS:[],quickFilterSectorID:"",orderBy:"date",order:"DESC",limit:10,categoryNames:[],sectorNames:[]};function ue(){const N=o.useRef(),[d,T]=o.useState(!1),[g,S]=o.useState([]),[L,D]=o.useState([]),[_,x]=o.useState(parseFloat(0).toFixed(2)),[a,E]=o.useState(""),[M,ee]=o.useState({id:null,user_id:null,account_id:"",amount:"",refundable_amount:0,refunded_amount:0,category_id:null,description:"",reference:"",date:"",note:"",attachment:""}),[n,u]=o.useState(f),[F,i]=o.useState(!0),[v,k]=o.useState(!1),{applicationSettings:Q}=o.useContext(G);let{default_currency:l}=Q;const[m,h]=o.useState(!1);l===void 0&&(l="AED ");const{data:s}=H({query:n},{skip:!F}),{data:c}=V();o.useEffect(()=>{document.title="Expenses Report",(s==null?void 0:s.expenses.length)>0?(S(s==null?void 0:s.expenses),x(s==null?void 0:s.totalExpense)):(S([]),x(parseFloat(0).toFixed(2))),c!=null&&c.data&&D(c.data)},[s==null?void 0:s.expenses]);const b=g.filter(t=>t.category_name.toLowerCase().includes(a==null?void 0:a.toLowerCase())||t.bank_name.toLowerCase().includes(a==null?void 0:a.toLowerCase())||t.amount.toLowerCase().includes(a==null?void 0:a.toLowerCase())||t.refundable_amount.toLowerCase().includes(a==null?void 0:a.toLowerCase())||t.refunded_amount.toLowerCase().includes(a==null?void 0:a.toLowerCase())||t.description.toLowerCase().includes(a==null?void 0:a.toLowerCase())),I=()=>{k(!1)},q=t=>{u(f),u({...n,quickFilterSectorID:t.target.value})},P=()=>{h(!m),i(!1)},R=()=>{i(!0),h(!1)},B=()=>{setQuery(f),i(!F)},j=()=>{h(!1)};return r("div",{children:[e($,{loaderVisible:d}),r(K,{fluid:!0,children:[r(C,{children:[e(p,{xs:6,md:4,children:e("div",{className:"form-group",children:e("input",{className:"custom-form-control",placeholder:"search by keywards",value:n.search_terms,onChange:t=>E(t.target.value)})})}),e(p,{xs:6,md:4,children:e("div",{className:"quick-filter",children:r(w,{className:"mb-3",children:[e(w.Text,{id:"auick-filter-by-sector",children:"Quick Filter"}),r(Z.Select,{value:n.quickFilterSectorID,"aria-label":"Filter By Sectors",id:"sector",name:"sector",onChange:t=>{q(t)},children:[e("option",{defaultValue:!0,disabled:!0,children:"Filter By Sectors"}),L.map(t=>e("option",{value:t.value,children:t.label},"sec-"+O(8)))]})]})})}),e(p,{xs:12,md:4,children:r("div",{className:"expense-filter-actionBtn",children:[r("button",{className:"btn btn-secondary btn-sm mr-2",onClick:P,children:[e(y,{icon:z})," Filter"]}),e(Y,{trigger:()=>r("button",{className:"btn btn-success btn-sm mr-2",children:[e(y,{icon:J})," Print"]}),content:()=>N.current})]})})]}),e(C,{children:e("div",{className:"report-table-containe",children:r("table",{className:"report-table",children:[e("thead",{children:r("tr",{className:"text-center",children:[e("th",{children:"Expense Date"}),e("th",{children:"Expense Category"}),e("th",{children:"Description"}),e("th",{children:"Expense Amount"})]})}),d&&e("tbody",{children:e("tr",{className:"text-center",children:e("td",{colSpan:4,className:"text-center",children:"Loading..."})})}),!d&&e("tbody",{children:b.length===0?e("tr",{children:e("td",{colSpan:4,className:"text-center",children:"Nothing found !"})}):b.map((t,A)=>r("tr",{className:"text-start",children:[e("td",{children:t.date}),e("td",{children:t.category_name}),r("td",{className:"report-descriptions",children:[e("span",{children:t.description}),e(U,{id:"expense-details"})]}),e("td",{className:"text-end",children:l+" "+t.amount})]},`exp-rep-${A}`))}),e("tfoot",{children:r("tr",{children:[e("td",{className:"text-center fw-bold",colSpan:2,children:"Total Expense"}),e("td",{className:"text-end fw-bold",colSpan:2,children:l+" "+_})]})})]})})})]}),v&&e(W,{handelCloseModal:I,title:"Expense Details",data:M,currency:l}),m&&e(X,{showModal:m,closeModal:j,resetFilter:B,submitFilter:R,queryParams:n,setQueryParams:u,setHasFilter:i})]})}export{ue as default};
