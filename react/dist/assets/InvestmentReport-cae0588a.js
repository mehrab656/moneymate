import{r as s,a as t,j as e,S,F as C,m as I}from"./index-8e1ee696.js";import{S as D,d as w}from"./SummeryCard-06eb799a.js";import{W as g}from"./WizCard-c3a4d722.js";import{e as x}from"./index-dc02ab6d.js";import{P as R,C as _,A as E,p as F,a as M}from"./index-845fc5ed.js";import{M as L,ae as y,ao as j,ap as A}from"./index-74298ed0.js";import{R as P}from"./index-80c335aa.js";import{B as T}from"./AuthRoutes-2e952a6b.js";import{B as k}from"./Button-0b808ca5.js";import"./jsx-runtime_commonjs-proxy-221d5456.js";import"./isMuiElement-18bae589.js";import"./useId-bebd534a.js";import"./useControlled-c67091af.js";import"./unsupportedIterableToArray-5ed4c917.js";import"./classCallCheck-25f3f0e0.js";_.register(E,F,M);function B({totalInvestment:c=1,investors:d=[],title:v,checkLoading:m=!1}){const[b,l]=s.useState([]),[h,u]=s.useState(m),N=()=>`#${Math.floor(Math.random()*16777215).toString(16)}`,p=()=>{u(!0);const n=d.filter(r=>r.name&&r.amount!=null).map(r=>{const f=Math.ceil((parseFloat(r.amount)||0)/c*100);return{label:r.name,value:f,backgroundColor:N()}});l(n),u(!1)};s.useEffect(()=>{p()},[c,d]);const o=[...b].sort((n,r)=>r.value-n.value),i={labels:o.map(n=>n.label),datasets:[{data:o.map(n=>n.value),backgroundColor:o.map(n=>n.backgroundColor)}]};return t("div",{style:{width:"100%"},children:[e("h1",{className:"title-text mb-0 text-center",children:v}),e("br",{}),h?e("p",{className:"text-center",children:"Loading..."}):o.length>0?e("div",{style:{display:"flex",justifyContent:"center"},children:e("div",{style:{width:"80%",maxWidth:"400px"},children:e(R,{data:i,options:{plugins:{legend:{position:"bottom",labels:{boxWidth:10,usePointStyle:!0}}}}},JSON.stringify(i))})}):e("p",{className:"text-center",children:"No data available"})]})}function te(){const c=s.useRef(),[d,v]=s.useState(0),[m,b]=s.useState([]),[l,h]=s.useState(!1),{applicationSettings:u,userRole:N}=s.useContext(S),[p,o]=s.useState(null),[i,n]=s.useState(null),{default_currency:r}=u,f=()=>{h(!0);try{I.get("/report/investment",{params:{start_date:p,end_date:i}}).then(({data:a})=>{v(a.totalInvestment),b(a.investments),h(!1)})}catch(a){console.warn(a)}};return s.useEffect(()=>{document.title="Investment Reports",f()},[]),t(C,{children:[e(L,{loaderVisible:l}),t("div",{className:"row mb-2",children:[e("div",{className:"col-md-4",children:e("span",{className:"page-title-header",children:"Investments"})}),t("div",{className:"col-md-8 text-end",children:[t("button",{className:"btn btn-secondary btn-sm mr-2",children:[e(y,{icon:j})," Download CSV"]}),t("button",{className:"btn-sm btn-add",children:[e(y,{icon:A})," Add Expense"]})]})]}),e("div",{className:"col-md-8",children:t(g,{className:"animated fadeInDown",children:[e("div",{className:"row",children:t("form",{onSubmit:a=>{a.preventDefault(),f()},children:[e("div",{className:"col-6",children:t("div",{className:"form-group",children:[e("label",{className:"custom-form-label",htmlFor:"start_date",children:"Start Date"}),e(x,{className:"custom-form-control",id:"start_date",selected:p,onChange:a=>o(a),dateFormat:"yyyy-MM-dd"})]})}),e("div",{className:"col-6",children:t("div",{className:"form-group",children:[e("label",{className:"custom-form-label",htmlFor:"end_date",children:"End Date:"}),e(x,{className:"custom-form-control",id:"end_date",selected:i,onChange:a=>n(a),dateFormat:"yyyy-MM-dd"})]})}),e("div",{className:"col-12",children:e("button",{className:"btn-add right",type:"submit",children:"Filter"})})]})}),e("div",{className:"row",ref:c,children:t("div",{className:"col-12",children:[e("h1",{className:"title-text text-center",children:"Total Investment Reports"}),t("table",{className:"table table-bordered custom-table",children:[e("thead",{children:t("tr",{className:"text-center",children:[e("th",{children:"Investor Name"}),e("th",{children:"Invested Amount"})]})}),l&&e("tbody",{children:e("tr",{className:"text-center",children:e("td",{colSpan:6,className:"text-center",children:"Loading..."})})}),!l&&e("tbody",{children:m.map(a=>t("tr",{className:"text-center",children:[e("td",{children:a.username}),e("td",{children:r+" "+a.amount})]},a.investor_id))})]})]})})]})}),e("div",{className:"col-md-4",children:t("div",{className:"row",children:[e("div",{className:"mb-4",children:e(D,{value:d,summary:"Total Investments",icon:e(w,{}),iconClassName:"icon-success",currency:r})}),t("div",{children:[e(g,{className:"animated fadeInDown",children:e(B,{totalInvestment:d,investors:m,checkLoading:l,title:"Investment chart"})}),e(T,{sx:{mt:1},display:"flex",justifyContent:"center",alignItems:"center",children:e(P,{trigger:()=>e(k,{sx:{ml:1},variant:"outlined",children:"Print"}),content:()=>c.current})})]})]})})]})}export{te as default};
