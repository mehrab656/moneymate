import{r as l,S as oe,m as d,j as e,a as n,L,d as re}from"./index-8e1ee696.js";import{W as H}from"./WizCard-c3a4d722.js";import{P as h}from"./Pagination-982a907e.js";import{M as ie,ae as O,at as U}from"./index-74298ed0.js";import{A as D}from"./ActionButtonHelpers-3cc0c4c9.js";import{S as E,d as de}from"./SummeryCard-06eb799a.js";import{d as me,a as ue}from"./AddCardTwoTone-be870dfa.js";import{b as R,n as p}from"./AuthRoutes-2e952a6b.js";import{M as C}from"./Modal-bc712426.js";import"./jsx-runtime_commonjs-proxy-221d5456.js";import"./isMuiElement-18bae589.js";import"./useId-bebd534a.js";import"./useControlled-c67091af.js";function Se(){const[_,r]=l.useState(!1),[W,j]=l.useState([]),[s,V]=l.useState(1),[$,z]=l.useState(0),[m,K]=l.useState(""),[M,x]=l.useState(!1),[Y,q]=l.useState(0),[G,J]=l.useState(0),[Q,X]=l.useState(0),[Z,ee]=l.useState([]),{applicationSettings:ae,userRole:b}=l.useContext(oe),{num_data_per_page:ne,default_currency:f}=ae,N=ne,g=Math.ceil($/N),[o,u]=l.useState({id:null,bank_name_id:null,account_name:"",account_number:"",balance:null}),[i,A]=l.useState({account_name:"",bank_name_id:"",account_number:"",balance:""}),[te,ce]=l.useState(null),T=()=>{u({id:null,bank_name_id:null,account_name:"",account_number:"",balance:null}),A({account_name:"",bank_name_id:"",account_number:"",balance:""}),x(!0)},I=()=>{x(!1)},w=()=>{d.get("/total-bankAccount-balance").then(({data:a})=>{q(a.balance)}),d.get("/total-wallet-balance").then(({data:a})=>{J(a.balance)}),d.get("/total-balance").then(({data:a})=>{X(a.balance)})};l.useEffect(()=>{document.title="Manage Bank Account",d.get("/all-bank").then(({data:a})=>{ee(a.data)}).catch(a=>{const c=a.response;c&&c.status===422&&A(c.data.errors)}),v(s,N),w()},[s,N]);const v=(a,c)=>{r(!0),d.get("/bank-accounts",{params:{page:a,pageSize:c}}).then(({data:t})=>{r(!1),j(t.data),z(t.total)}).catch(()=>{r(!1)})},k=a=>{V(a)},y=[];for(let a=1;a<=g;a++)y.push(e(h.Item,{active:a===s,onClick:()=>k(a),children:a},a));const le=a=>{a.preventDefault(),r(!0),o.id?d.put(`/bank-account/${o.id}`,o).then(c=>{x(!1),v(s,N),w(),u({id:null,bank_name_id:null,account_name:"",account_number:"",balance:null}),A({account_name:"",bank_name_id:"",account_number:"",balance:""}),p("success",c.message,c.description),r(!1)}).catch(c=>{const t=c.response.data;p("error",t==null?void 0:t.message,t.description),r(!1)}):d.post("/bank-account/add",o).then(c=>{x(!1),v(s,N),w(),u({id:null,bank_name_id:null,account_name:"",account_number:"",balance:null}),A({account_name:"",bank_name_id:"",account_number:"",balance:""}),p("success",c.message,c.description),r(!1)}).catch(c=>{const t=c.response.data;p("error",t==null?void 0:t.message,t.description),r(!1)})},se=a=>{re.fire({title:"Are you sure?",text:`Removing bank account number ${a.account_number} will also erase all the associated data from the system`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"}).then(c=>{c.isConfirmed&&d.delete(`/bank-account/${a.id}`).then(({data:t})=>{v(s,N),p("success",t==null?void 0:t.message,t==null?void 0:t.description)}).catch(t=>{const S=t.response.data;p("error",S==null?void 0:S.message,S.description),r(!1)})})},F=a=>{K(a.target.value)},B=W.filter(a=>a.customer_name.toLowerCase().includes(m.toLowerCase())||a.account_name.toLowerCase().includes(m.toLowerCase())||a.bank_name.toLowerCase().includes(m.toLowerCase())||a.account_number.includes(m)||a.balance.toString().includes(m)),P=[{actionName:"Edit",type:"route",route:"/account/",actionFunction:"editModal",permission:"account_edit",textClass:"text-info"},{actionName:"View",type:"modal",route:"",actionFunction:M,permission:"account_view",textClass:"text-warning"},{actionName:"Delete",type:"modal",route:"",actionFunction:se,permission:"account_delete",textClass:"text-danger"}];return n("div",{children:[e(ie,{loaderVisible:_}),e("div",{className:"mb-4",children:n("div",{className:"row g-4",children:[e("div",{className:"col-md-6 col-lg-4",children:e(E,{value:Y,summary:"Account Balance",icon:e(de,{}),iconClassName:"icon-success",currency:f})}),e("div",{className:"col-md-6 col-lg-4",children:e(E,{value:G,summary:"Wallet Balance",icon:e(me,{}),iconClassName:"icon-danger",currency:f})}),e("div",{className:"col-md-6 col-lg-4",children:e(E,{value:Q,summary:"Total Balance",icon:e(ue,{}),iconClassName:"icon-success",currency:f})})]})}),n(H,{className:"animated fadeInDown",children:[n("div",{className:"d-flex justify-content-between align-content-center gap-2 mb-3",children:[e("h1",{className:"title-text mb-0",children:"Bank Account"}),e("div",{children:n(L,{className:"custom-btn btn-add",onClick:T,children:[e(O,{icon:U})," Add New Bank Account"]})})]}),n("div",{className:"alert alert-warning",role:"alert",children:["You need to create a bank before add a bank account, if you haven't added a bank yet, ",e(L,{to:"/banks",children:"Click Here"})," to create a bank first."]}),e("div",{className:"mb-4",children:e("input",{className:"custom-form-control",type:"text",placeholder:"Search Account...",value:m,onChange:F})}),e("div",{className:"table-responsive-sm",children:n("table",{className:"table table-bordered custom-table",children:[e("thead",{children:n("tr",{children:[b==="admin"&&e("th",{children:"id"}),e("th",{children:"USER NAME"}),e("th",{className:"text-center",children:"ACCOUNT HOLDER NAME"}),e("th",{className:"text-center",children:"BANK NAME"}),e("th",{className:"text-center",children:"ACCOUNT NUMBER"}),e("th",{className:"text-center",children:"AVAILABLE BALANCE"}),b==="admin"&&e("th",{className:"text-center",width:"20%",children:"ACTIONS"})]})}),_&&e("tbody",{children:e("tr",{children:e("td",{colSpan:6,className:"text-center",children:"Loading...."})})}),!_&&e("tbody",{children:B.length===0?e("tr",{children:e("td",{colSpan:6,className:"text-center",children:"No bank account found"})}):B.map(a=>n("tr",{children:[b==="admin"&&e("td",{children:a.id}),e("td",{children:a.customer_name}),e("td",{className:"text-center",children:a.account_name}),e("td",{className:"text-center",children:a.bank_name}),e("td",{className:"text-center",children:a.account_number}),n("td",{className:"text-center",children:[f+" ",a.balance]}),b==="admin"&&e("td",{children:e(D,{actionBtn:P,element:a})})]},a.id))})]})}),g>1&&n(h,{children:[e(h.Prev,{disabled:s===1,onClick:()=>k(s-1)}),y,e(h.Next,{disabled:s===g,onClick:()=>k(s+1)})]})]}),n(H,{className:"animated fadeInDown mt-4",children:[n("div",{className:"d-flex justify-content-between align-content-center gap-2 mb-3",children:[e("h1",{className:"title-text mb-0",children:"Wallet/Handcash"}),e("div",{children:n(L,{className:"custom-btn btn-add",onClick:T,children:[e(O,{icon:U})," Add New Wallet"]})})]}),e("div",{className:"mb-4",children:e("input",{className:"custom-form-control",type:"text",placeholder:"Search Account...",value:m,onChange:F})}),e("div",{className:"table-responsive-sm",children:n("table",{className:"table table-bordered custom-table",children:[e("thead",{children:n("tr",{children:[e("th",{children:"WALLET NAME"}),e("th",{className:"text-center",children:"ACCOUNT HOLDER NAME"}),e("th",{className:"text-center",children:"BANK NAME"}),e("th",{className:"text-center",children:"ACCOUNT NUMBER"}),e("th",{className:"text-center",children:"AVAILABLE BALANCE"}),b==="admin"&&e("th",{className:"text-center",width:"20%",children:"ACTIONS"})]})}),_&&e("tbody",{children:e("tr",{children:e("td",{colSpan:6,className:"text-center",children:"Loading...."})})}),!_&&e("tbody",{children:B.length===0?e("tr",{children:e("td",{colSpan:6,className:"text-center",children:"No bank account found"})}):B.map(a=>n("tr",{children:[e("td",{children:a.customer_name}),e("td",{className:"text-center",children:a.account_name}),e("td",{className:"text-center",children:a.bank_name}),e("td",{className:"text-center",children:a.account_number}),n("td",{className:"text-center",children:[f,a.balance]}),b==="admin"&&e("td",{children:e(D,{actionBtn:P,element:a})})]},a.id))})]})}),g>1&&n(h,{children:[e(h.Prev,{disabled:s===1,onClick:()=>k(s-1)}),y,e(h.Next,{disabled:s===g,onClick:()=>k(s+1)})]})]}),n(C,{show:M,centered:!0,onHide:I,className:"custom-modal",children:[e(C.Header,{closeButton:!0,children:n(C.Title,{children:[o.id&&e("span",{className:"title-text",children:"Update bank account information"}),!o.id&&e("span",{className:"title-text",children:"Add new bank account"})]})}),n(C.Body,{children:[n("div",{className:"form-group",children:[e("label",{htmlFor:"account_name",className:"custom-form-label",children:"Account holders Name"}),e("input",{className:"custom-form-control",value:o.account_name||"",type:"text",onChange:a=>u({...o,account_name:a.target.value}),placeholder:"Account holders Name"}),i.account_name&&e("div",{className:"error-message mt-2",children:i.account_name})]}),n("div",{className:"form-group",children:[e("label",{htmlFor:"bank_name",className:"custom-form-label",children:"Bank Name"}),n("select",{className:"custom-form-control",id:"bank-name",name:"bank-name",value:te||"",onChange:a=>{const c=a.target.value||"";ce(c),u({...o,bank_name_id:parseInt(c)})},children:[e("option",{defaultValue:!0,children:"Select a bank account"}),Z.map(a=>e("option",{value:a.id,children:a.bank_name},a.id))]}),i.bank_name_id&&e("div",{className:"error-message mt-2",children:i.bank_name_id})]}),n("div",{className:"form-group",children:[e("label",{htmlFor:"account_number",className:"custom-form-label",children:"Account Number"}),e("input",{className:"custom-form-control",value:o.account_number||"",type:"text",onChange:a=>u({...o,account_number:a.target.value}),placeholder:"Account Number"}),i.account_number&&e("div",{className:"error-message mt-2",children:i.account_number})]}),n("div",{className:"form-group",children:[e("label",{htmlFor:"initial_balance",className:"custom-form-label",children:"Initial Balance"}),e("input",{className:"custom-form-control",value:o.balance||"",type:"text",onChange:a=>u({...o,balance:a.target.value}),placeholder:"Balance"}),i.balance&&e("div",{className:"error-message mt-2",children:i.balance})]})]}),n(C.Footer,{children:[e(R,{className:"btn-sm",variant:"primary",onClick:le,children:"Save"}),e(R,{className:"btn-sm",variant:"secondary",onClick:I,children:"Close"})]})]})]})}export{Se as default};
