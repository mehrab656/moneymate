import{j as e,a as c,F as M,f as E,af as U,r as u,e as B,S as P,m as j}from"./index-8e1ee696.js";import{W}from"./WizCard-c3a4d722.js";import{B as I}from"./Badge-ce00077f.js";import{M as H}from"./index-74298ed0.js";import{m as V}from"./makeStyles-7d66d76c.js";import{T as $,a as q,b as G,c as L,d as N,e as J}from"./TableRow-3c1023d1.js";import{P as K,n as Q}from"./AuthRoutes-2e952a6b.js";import{F as R}from"./FormControlLabel-95d9d126.js";import{C as A}from"./Checkbox-ece7f89d.js";import"./unsupportedIterableToArray-5ed4c917.js";import"./toConsumableArray-46a81798.js";import"./useFormControl-e95281cb.js";import"./Typography-e228ba3d.js";import"./Stack-7b3bc405.js";import"./SwitchBase-353c16ce.js";import"./useControlled-c67091af.js";const X=V(v=>({fontSize:{"& span:last-child":{fontSize:2}},size:{width:40,height:40}}));function Y({permissions:v,setPermissions:i}){X();const m=Object.entries(v),x=(d,s)=>{const{name:_,checked:n}=d.target;(s==="investment"||s==="expense"||s==="income"||s==="return")&&n===!0&&i(a=>({...a,submenuTransactionVisible:!0})),i(_==="selectAll"?a=>({...a,[s]:Object.keys(a[s]).reduce((p,b)=>(p[b]=n,p),{})}):a=>({...a,[s]:{...a[s],[_]:n}}))},g=(d,s)=>{const{checked:_}=d.target;i(n=>({...n,[s]:Object.keys(n[s]).reduce((a,p)=>(a[p]=_,a),{})}))};return e($,{component:K,children:c(q,{sx:{minWidth:650},size:"small","aria-label":"a dense table",children:[e(G,{children:e(L,{children:e(N,{colSpan:11,children:"Permissions"})})}),m&&m.map((d,s)=>{const _=Object.entries(d[1]);function n(b){let o=b.toLowerCase().split("_");for(let h=0;h<o.length;h++)o[h]=o[h].charAt(0).toUpperCase()+o[h].slice(1);return o.join(" ")}const a=n(d[0]);return e(M,{children:e(J,{children:[{name:"Frozen yoghurt",calories:"159",fat:"6.0",carbs:"24",protein:"4.0"}].map(b=>c(L,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e(N,{children:e(R,{sx:{"& .MuiFormControlLabel-label":{fontSize:"15px",fontWeight:"bold"},"& .MuiFormControlLabel-control":{fontSize:"5px"}},control:e(A,{checked:Object.values(d[1]).every(Boolean),onChange:o=>g(o,d[0]),name:"selectAll",sx:{"& .MuiSvgIcon-root":{fontSize:14}}}),label:a})}),e(N,{}),_.map((o,h)=>{const k=o[0].split("_").pop();return e(N,{align:"right",children:e(R,{control:e(A,{checked:o[1],onChange:C=>x(C,d[0]),name:o[0],sx:{"& .MuiSvgIcon-root":{fontSize:18}}}),label:k,sx:{textTransform:"capitalize"}},o[0])})})]},b.name))})})})]})})}function he(){const v=E();let{id:i}=U();const[m,x]=u.useState({name:"",status:1,roles:{}}),[g,d]=u.useState({}),[s,_]=u.useState(null),[n,a]=u.useState(!1),[p,b]=u.useState([]),{setNotification:o}=B(),{applicationSettings:h,userRole:k}=u.useContext(P),{default_currency:C,registration_type:O}=h,[t,T]=u.useState({company:{company_create:(g==null?void 0:g.company_create)===!0,company_view:!1,company_edit:!1,company_delete:!1},sector:{sector_create:!1,sector_view:!1,sector_edit:!1,sector_delete:!1},category:{category_create:!1,category_view:!1,category_edit:!1,category_delete:!1},investment:{investment_create:!1,investment_view:!1,investment_edit:!1,investment_delete:!1},expense:{expense_create:!1,expense_view:!1,expense_edit:!1,expense_delete:!1},income:{income_create:!1,income_view:!1,income_edit:!1,income_delete:!1},return:{return_create:!1,return_view:!1,return_edit:!1,return_delete:!1},income_report:{income_report_create:!1,income_report_view:!1,income_report_edit:!1,income_report_delete:!1},expense_report:{expense_report_create:!1,expense_report_view:!1,expense_report_edit:!1,expense_report_delete:!1},investment_report:{investment_report_create:!1,investment_report_view:!1,investment_report_edit:!1,investment_report_delete:!1},monthly_report:{monthly_report_create:!1,monthly_report_view:!1,monthly_report_edit:!1,monthly_report_delete:!1},overall_report:{overall_report_create:!1,overall_report_view:!1,overall_report_edit:!1,overall_report_delete:!1},bank:{bank_create:!1,bank_view:!1,bank_edit:!1,bank_delete:!1},account:{account_create:!1,account_view:!1,account_edit:!1,account_delete:!1},balance:{balance_create:!1,balance_view:!1,balance_edit:!1,balance_delete:!1},debt:{debt_create:!1,debt_view:!1,debt_edit:!1,debt_delete:!1},loans:{loans_create:!1,loans_view:!1,loans_edit:!1,loans_delete:!1},employee:{employee_create:!1,employee_view:!1,employee_edit:!1,employee_delete:!1},task:{task_create:!1,task_view:!1,task_edit:!1,task_delete:!1},attendance:{attendance_create:!1,attendance_view:!1,attendance_edit:!1,attendance_delete:!1},asset:{asset_create:!1,asset_view:!1,asset_edit:!1,asset_delete:!1},budget:{budget_create:!1,budget_view:!1,budget_edit:!1,budget_delete:!1},investment_plan:{investment_plan_create:!1,investment_plan_view:!1,investment_plan_edit:!1,investment_plan_delete:!1},calender:{calender_create:!1,calender_view:!1,calender_edit:!1,calender_delete:!1},activity_log:{activity_log_create:!1,activity_log_view:!1,activity_log_edit:!1,activity_log_delete:!1},settings:{settings_create:!1,settings_view:!1,settings_edit:!1,settings_delete:!1},user:{user_create:!1,user_view:!1,user_edit:!1,user_delete:!1},profile:{profile_create:!1,profile_view:!1,profile_edit:!1,profile_delete:!1},role:{role_create:!1,role_view:!1,role_edit:!1,role_delete:!1},dashboard:{dashboard_monthly_income:!1,dashboard_monthly_expense:!1,dashboard_account_balance:!1,dashboard_lend_amount:!1,dashboard_borrow_amount:!1,dashboard_total_bank:!1,dashboard_expense_chart:!1,dashboard_exp_budget:!1,dashboard_active_budget:!1}});u.useEffect(()=>{i&&(document.title="Update Role",a(!0),j.get(`/role/${i}`).then(({data:l})=>{var f,F;a(!1),x({...m,role:(f=l==null?void 0:l.data)==null?void 0:f.role});const y=(F=l==null?void 0:l.data)==null?void 0:F.permissions,r={...t};Object.keys(y).forEach(z=>{var w;const S=z.split("_");S.length>2?w=S[0]+"_"+S[1]:w=S[0],r[w]&&(r[w][z]=y[z])}),T(r)}).catch(()=>{a(!1)}))},[i]);const D=l=>{l.preventDefault(),a(!0);const y={...m,roles:{...t.company,...t.sector,...t.category,...t.investment,...t.expense,...t.income,...t.return,...t.income_report,...t.expense_report,...t.investment_report,...t.monthly_report,...t.overall_report,...t.bank,...t.account,...t.balance,...t.debt,...t.loans,...t.employee,...t.task,...t.attendance,...t.asset,...t.budget,...t.investment_plan,...t.calender,...t.activity_log,...t.settings,...t.user,...t.profile,...t.role,...t.dashboard}};i?j.post(`/role/update/${i}`,y).then(()=>{o("Role was successfully updated"),k==="admin"&&v("/roles"),a(!1)}).catch(r=>{const f=r.response;f&&f.status===422&&_(f.data.errors),a(!1)}):j.post("/role/add",y).then(({data:r})=>{Q(r==null?void 0:r.status,r==null?void 0:r.message,r==null?void 0:r.description),v("/roles"),a(!1)}).catch(r=>{const f=r.response;f&&f.status===422&&_(f.data.errors),a(!1)})};return c(M,{children:[e(H,{loaderVisible:n}),i&&c("h1",{className:"title-text",children:["Update role: ",m.name]}),!i&&e("h1",{className:"title-text",children:"New role"}),c(W,{className:"animated fadeInDown wiz-card-mh",children:[n&&e("div",{className:"text-center",children:"Loading..."}),!n&&c("form",{onSubmit:D,className:"custom-form",children:[c("div",{className:"form-group",children:[e("label",{htmlFor:"role_nmae",className:"custom-form-label",children:"Role Name"}),e("input",{className:"custom-form-control",value:m.name,onChange:l=>x({...m,name:l.target.value}),placeholder:"Name"}),(s==null?void 0:s.name)&&e("p",{className:"error-message mt-2",children:s==null?void 0:s.name[0]})]}),e(Y,{permissions:t,setPermissions:T},Math.random().toString(36).substring(2)),e("div",{className:"text-end mt-4",children:e("button",{className:"custom-btn btn-brand-primary btn-edit px-5",children:i?"Update":"Create"})})]}),O==="subscription"&&c("div",{className:"table-responsive-sm mt-4",children:[e("div",{className:"text-danger mb-2",children:e("div",{className:"alert alert-info",role:"alert",children:"Subscription History"})}),c("table",{className:"table table-bordered custom-table",children:[e("thead",{children:c("tr",{className:"text-center",children:[e("th",{children:"Start Date"}),e("th",{children:"End Date"}),e("th",{children:"Status"}),e("th",{children:"Amount"})]})}),n&&e("tbody",{children:e("tr",{children:e("td",{colSpan:4,className:"text-center",children:"Loading..."})})}),!n&&e("tbody",{children:p.length===0?e("tr",{children:e("td",{colSpan:4,className:"text-center",children:"No Subscription found"})}):p.map(l=>c("tr",{className:"text-center",children:[e("td",{children:l.current_period_start}),e("td",{children:l.current_period_end}),e("td",{children:e(I,{className:l.status==="active"?"badge-active":"badge-inactive",children:l.status.charAt(0).toUpperCase()+l.status.slice(1)})}),c("td",{children:[" ",C+l.amount]})]},l.id))})]})]})]})]})}export{he as default};
