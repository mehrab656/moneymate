import{e as S,af as F,r as u,f as A,a as d,F as M,j as e,m as T}from"./index-8e1ee696.js";import{e as N}from"./index-dc02ab6d.js";import{W as k}from"./WizCard-c3a4d722.js";import{M as R}from"./index-74298ed0.js";import"./AuthRoutes-2e952a6b.js";import"./unsupportedIterableToArray-5ed4c917.js";import"./classCallCheck-25f3f0e0.js";function $(){const{user:h}=S();F();const[t,m]=u.useState({id:null,plan_name:null,userId:h&&(h==null?void 0:h.id),date:null,startDate:null,endDate:null}),[E,y]=u.useState({}),[D,c]=u.useState(!1),{setNotification:w}=S(),P=A(),[i,f]=u.useState([{purpose:"",paymentTerms:"",amount:"",refundableAmount:"",remarks:""}]),_=()=>{f([...i,{purpose:"",paymentTerms:"",amount:"",refundableAmount:"",remarks:""}])},I=s=>{const a=[...i];a.splice(s,1),f(a)},p=(s,a,n)=>{const o=[...i];o[a][n]=s.target.value,f(o)};u.useEffect(()=>{(t==null?void 0:t.date)===null&&m({...t,date:new Date().toISOString().split("T")[0],startDate:new Date().toISOString().split("T")[0]})},[t==null?void 0:t.date,t==null?void 0:t.startDate]);const x=s=>{if(s.preventDefault(),c(!0),t.id){const{userId:a,date:n,startDate:o,endDate:b}=t,r=new FormData;r.append("user_id",a),r.append("date",n),r.append("start_date",o),r.append("end_date",b),T.post(`/investment-plan/${t.id}`,r,{headers:{"Content-Type":"multipart/form-data"}}).then(({data:g})=>{w("Plan data has been updated"),P("/investment-plan"),c(!1)}).catch(g=>{const l=g.response;l&&l.status===422&&y(l.data.errors),c(!1)})}else{const{userId:a,plan_name:n,date:o,startDate:b,endDate:r,purposes:g}=t,l=new FormData;l.append("user_id",a),l.append("plan_name",n),l.append("date",o),l.append("start_date",b),l.append("end_date",r),l.append("purposes",i),T.post("/investments/add-new-plan",l,{headers:{"Content-Type":"multipart/form-data"}}).then(({data:C})=>{w("Plan data has been added"),c(!1)}).catch(C=>{const v=C.response;v&&v.status===422&&y(v.data.errors),c(!1)})}};return d(M,{children:[e(R,{loaderVisible:D}),d("div",{className:"d-flex justify-content-between align-content-center gap-2 mb-3",children:[t.id&&e("h1",{className:"title-text mb-0",children:"Update Investment Plan "}),!t.id&&e("h1",{className:"title-text mb-0",children:"Add New Investment Plan"})]}),d(k,{className:"animated fadeInDown wiz-card-mh",children:[D&&e("div",{className:"text-center",children:"Loading..."}),!D&&d("form",{onSubmit:x,children:[d("div",{className:"row",children:[d("div",{className:"col-md-6",children:[d("div",{className:"form-group",children:[e("label",{className:"custom-form-label",htmlFor:"plan_name",children:"Plan Name"}),e("input",{className:"custom-form-control",type:"text",step:"any",value:t.plan_name||"",onChange:s=>m({...t,plan_name:s.target.value}),placeholder:"Plan Name"})]}),d("div",{className:"form-group",children:[e("label",{className:"custom-form-label",htmlFor:"plan_start_date",children:"Start Date(Contact Period)"}),e(N,{className:"custom-form-control",selected:t.startDate?new Date(t.startDate):new Date,onChange:s=>{const a=s?new Date(s):null,n=a&&!t.startDate?new Date(a.getTime()+24*60*60*1e3):a;m({...t,startDate:n?n.toISOString().split("T")[0]:""})},dateFormat:"yyyy-MM-dd",placeholderText:"Start Date(Contact Period)"})]})]}),d("div",{className:"col-md-6",children:[d("div",{className:"form-group",children:[e("label",{className:"custom-form-label",htmlFor:"plan_date",children:"Plan Date"}),e(N,{className:"custom-form-control",selected:t.date?new Date(t.date):new Date,onChange:s=>{const a=s?new Date(s):null,n=a&&!t.date?new Date(a.getTime()+24*60*60*1e3):a;m({...t,date:n?n.toISOString().split("T")[0]:""})},dateFormat:"yyyy-MM-dd",placeholderText:"Income Date"})]}),d("div",{className:"form-group",children:[e("label",{className:"custom-form-label",htmlFor:"plan_end_date",children:"End Date(Contact Period)"}),e(N,{className:"custom-form-control",selected:t.endDate?new Date(t.endDate):new Date,onChange:s=>{const a=s?new Date(s):null,n=a&&!t.endDate?new Date(a.getTime()+24*60*60*1e3):a;m({...t,endDate:n?n.toISOString().split("T")[0]:""})},dateFormat:"yyyy-MM-dd",placeholderText:"End Date(Contact Period)"})]})]})]}),e("div",{className:"row mt-3",children:e("div",{className:"col-md-12",children:d("table",{children:[e("thead",{children:d("tr",{children:[e("th",{children:"Purpose"}),e("th",{children:"Payment Terms"}),e("th",{children:"Amount"}),e("th",{children:"Refundable Amount"}),e("th",{children:"Remarks"}),e("th",{children:"Actions"})]})}),e("tbody",{children:i.map((s,a)=>d("tr",{children:[e("td",{children:e("input",{type:"text",value:s.purpose,onChange:n=>p(n,a,"purpose")})}),e("td",{children:e("input",{type:"text",value:s.paymentTerms,onChange:n=>p(n,a,"paymentTerms")})}),e("td",{children:e("input",{type:"number",value:s.amount,onChange:n=>p(n,a,"amount")})}),e("td",{children:e("input",{type:"number",value:s.refundableAmount,onChange:n=>p(n,a,"refundableAmount")})}),e("td",{children:e("input",{type:"text",value:s.remarks,onChange:n=>p(n,a,"remarks")})}),e("td",{children:d("div",{className:"d-grid gap-2 d-md-flex",children:[e("button",{className:"btn btn-sm btn-danger",onClick:()=>I(a),title:"Remove this row",children:"-"}),e("button",{className:"btn btn-sm btn-info",onClick:_,title:"Add a new row",children:"+"})]})})]},a))})]})})}),e("button",{className:t.id?"btn btn-info float-right mt:3":"custom-btn btn-add mt:3",children:t.id?"Update Plan Record":"Add Plan"})]})]})]})}export{$ as default};
