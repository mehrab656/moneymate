import{r as d,j as t,M as At,h as $t,G as Nt,P as Tt,Q as Ft,F as tt,a as n,S as Rt,T as Et,U as _t,d as Pt}from"./index-8e1ee696.js";import{i as St,h as Mt,j as kt,b as M,o as Lt,l as zt,_ as Gt,c as wt,k as B,m as Dt,M as ft}from"./index-74298ed0.js";import{G as J,n as et,R as ct,a as Z,b as Vt,d as Ht}from"./AuthRoutes-2e952a6b.js";import{I as Ut}from"./Iconify-5a94efd0.js";import{C as It}from"./CommonTable-27ef35ac.js";import{M as P}from"./Modal-bc712426.js";import{C as st,a as ut}from"./CardContent-2022634c.js";import{T as pt}from"./Typography-e228ba3d.js";import{T as Ot,a as Qt,b as Wt,c as ht,d as C,e as jt}from"./TableRow-3c1023d1.js";import{a as qt,b as Jt,B as Y}from"./Button-0b808ca5.js";import{a as Yt,C as Kt}from"./Card-e4e45dfb.js";import{S as Xt}from"./Stack-0f0f80e9.js";import{F as _}from"./Form-833e738d.js";import"./ActionButtonHelpers-3cc0c4c9.js";import"./jsx-runtime_commonjs-proxy-221d5456.js";import"./isMuiElement-18bae589.js";import"./useId-bebd534a.js";import"./useControlled-c67091af.js";import"./makeStyles-7d66d76c.js";import"./unsupportedIterableToArray-5ed4c917.js";import"./toConsumableArray-46a81798.js";import"./Collapse-bfde31ed.js";import"./Stack-7b3bc405.js";import"./Pagination-fd6e0edf.js";import"./LastPage-4ffce3d8.js";import"./CardHeaderContext-cb83d0a9.js";function Zt(r){return d.Children.toArray(r).filter(e=>d.isValidElement(e))}function te(r){return Mt("MuiButtonGroup",r)}const ee=St("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),g=ee,oe=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],re=(r,e)=>{const{ownerState:o}=r;return[{[`& .${g.grouped}`]:e.grouped},{[`& .${g.grouped}`]:e[`grouped${B(o.orientation)}`]},{[`& .${g.grouped}`]:e[`grouped${B(o.variant)}`]},{[`& .${g.grouped}`]:e[`grouped${B(o.variant)}${B(o.orientation)}`]},{[`& .${g.grouped}`]:e[`grouped${B(o.variant)}${B(o.color)}`]},{[`& .${g.firstButton}`]:e.firstButton},{[`& .${g.lastButton}`]:e.lastButton},{[`& .${g.middleButton}`]:e.middleButton},e.root,e[o.variant],o.disableElevation===!0&&e.disableElevation,o.fullWidth&&e.fullWidth,o.orientation==="vertical"&&e.vertical]},ne=r=>{const{classes:e,color:o,disabled:i,disableElevation:l,fullWidth:F,orientation:m,variant:N}=r,h={root:["root",N,m==="vertical"&&"vertical",F&&"fullWidth",l&&"disableElevation"],grouped:["grouped",`grouped${B(m)}`,`grouped${B(N)}`,`grouped${B(N)}${B(m)}`,`grouped${B(N)}${B(o)}`,i&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return Dt(h,te,e)},ae=kt("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:re})(({theme:r,ownerState:e})=>M({display:"inline-flex",borderRadius:(r.vars||r).shape.borderRadius},e.variant==="contained"&&{boxShadow:(r.vars||r).shadows[2]},e.disableElevation&&{boxShadow:"none"},e.fullWidth&&{width:"100%"},e.orientation==="vertical"&&{flexDirection:"column"},{[`& .${g.grouped}`]:M({minWidth:40,"&:hover":M({},e.variant==="contained"&&{boxShadow:"none"})},e.variant==="contained"&&{boxShadow:"none"}),[`& .${g.firstButton},& .${g.middleButton}`]:M({},e.orientation==="horizontal"&&{borderTopRightRadius:0,borderBottomRightRadius:0},e.orientation==="vertical"&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},e.variant==="text"&&e.orientation==="horizontal"&&{borderRight:r.vars?`1px solid rgba(${r.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${r.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${g.disabled}`]:{borderRight:`1px solid ${(r.vars||r).palette.action.disabled}`}},e.variant==="text"&&e.orientation==="vertical"&&{borderBottom:r.vars?`1px solid rgba(${r.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${r.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${g.disabled}`]:{borderBottom:`1px solid ${(r.vars||r).palette.action.disabled}`}},e.variant==="text"&&e.color!=="inherit"&&{borderColor:r.vars?`rgba(${r.vars.palette[e.color].mainChannel} / 0.5)`:Lt(r.palette[e.color].main,.5)},e.variant==="outlined"&&e.orientation==="horizontal"&&{borderRightColor:"transparent"},e.variant==="outlined"&&e.orientation==="vertical"&&{borderBottomColor:"transparent"},e.variant==="contained"&&e.orientation==="horizontal"&&{borderRight:`1px solid ${(r.vars||r).palette.grey[400]}`,[`&.${g.disabled}`]:{borderRight:`1px solid ${(r.vars||r).palette.action.disabled}`}},e.variant==="contained"&&e.orientation==="vertical"&&{borderBottom:`1px solid ${(r.vars||r).palette.grey[400]}`,[`&.${g.disabled}`]:{borderBottom:`1px solid ${(r.vars||r).palette.action.disabled}`}},e.variant==="contained"&&e.color!=="inherit"&&{borderColor:(r.vars||r).palette[e.color].dark},{"&:hover":M({},e.variant==="outlined"&&e.orientation==="horizontal"&&{borderRightColor:"currentColor"},e.variant==="outlined"&&e.orientation==="vertical"&&{borderBottomColor:"currentColor"})}),[`& .${g.lastButton},& .${g.middleButton}`]:M({},e.orientation==="horizontal"&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},e.orientation==="vertical"&&{borderTopRightRadius:0,borderTopLeftRadius:0},e.variant==="outlined"&&e.orientation==="horizontal"&&{marginLeft:-1},e.variant==="outlined"&&e.orientation==="vertical"&&{marginTop:-1})})),ie=d.forwardRef(function(e,o){const i=zt({props:e,name:"MuiButtonGroup"}),{children:l,className:F,color:m="primary",component:N="div",disabled:h=!1,disableElevation:b=!1,disableFocusRipple:R=!1,disableRipple:k=!1,fullWidth:S=!1,orientation:O="horizontal",size:T="medium",variant:E="outlined"}=i,p=Gt(i,oe),U=M({},i,{color:m,component:N,disabled:h,disableElevation:b,disableFocusRipple:R,disableRipple:k,fullWidth:S,orientation:O,size:T,variant:E}),y=ne(U),x=d.useMemo(()=>({className:y.grouped,color:m,disabled:h,disableElevation:b,disableFocusRipple:R,disableRipple:k,fullWidth:S,size:T,variant:E}),[m,h,b,R,k,S,T,E,y.grouped]),L=Zt(l),K=L.length,A=z=>{const G=z===0,f=z===K-1;return G&&f?"":G?y.firstButton:f?y.lastButton:y.middleButton};return t(ae,M({as:N,role:"group",className:wt(y.root,F),ref:o,ownerState:U},p,{children:t(qt.Provider,{value:x,children:L.map((z,G)=>t(Jt.Provider,{value:A(G),children:z},G))})}))}),le=ie,mt={id:"",sector_id:"",account_id:"",category_id:"",date:""},gt=[{name:"",description:"",qty:0,unit_price:0,total_price:0,total_used:0,total_damage:0,status:!0}];function de({handelCloseModal:r,id:e}){const[o,i]=d.useState(mt),[l,F]=d.useState({}),[m,N]=d.useState(!1),[h,b]=d.useState(gt),[R,k]=d.useState([]),[S,O]=d.useState([]),[T,E]=d.useState([]),{data:p,isFetching:U,isError:y}=At({id:e},{skip:!e}),{data:x,isFetching:L,isError:K}=$t(),{data:A,isFetching:z,isError:G}=Nt({currentPage:"",pageSize:100}),{data:f,isFetching:ot,isError:nt}=Tt({id:o==null?void 0:o.sector_id},{skip:(o==null?void 0:o.sector_id)===""}),[Q]=Ft();d.useEffect(()=>{var a;e&&p&&(i((p==null?void 0:p.data)??mt),E((p==null?void 0:p.categories)??[]),b(p!=null&&p.data?JSON.parse((a=p==null?void 0:p.data)==null?void 0:a.assets):[]))},[p,e]),d.useEffect(()=>{!e&&(f!=null&&f.categories)&&E(f==null?void 0:f.categories)},[f,e]),d.useEffect(()=>{x!=null&&x.data&&O(x==null?void 0:x.data),A!=null&&A.data&&k(A==null?void 0:A.data)},[x,A]);const W=a=>{const{name:c,value:s}=a.target;i({...o,[c]:s})},j=a=>{E([]),i({...o,sector_id:a.target.value})},w=(a,c)=>{const{name:s,value:D}=a.target,u=[...h];u[c][s]=D,b(u)},$=a=>{const c=h[a],s=c.qty,D=c.unit_price,u=s*D,X=[...h];X[a].total_price=u,b(X)},rt=()=>{b([...h,{name:"",description:"",qty:0,unit_price:0,total_price:0,status:"",total_used:0,total_damage:0}])},at=a=>{const c=[...h];c.splice(a,1),b(c)},q=async(a,c)=>{a.preventDefault();let s=new FormData;s.append("sector_id",o.sector_id),s.append("category_id",o.category_id),s.append("account_id",o.account_id),s.append("date",o.date),s.append("assets",JSON.stringify(h)),e&&s.append("id",e);const D=e?`/asset/${e}`:"/asset/add";try{const u=await Q({url:D,formData:o}).unwrap();et("success",u==null?void 0:u.message,u==null?void 0:u.description),c?b(gt):r()}catch(u){et("error",(u==null?void 0:u.message)||"An error occurred",(u==null?void 0:u.description)||"Please try again later.")}};return t(tt,{children:n(P,{show:!0,centered:!0,onHide:r,backdrop:"static",keyboard:!1,size:"lg",children:[t(P.Header,{closeButton:!0,children:t(P.Title,{children:n("span",{children:[e?"Update":"Add"," Asset"]})})}),n(P.Body,{children:[t(ft,{loaderVisible:m}),t(st,{children:n(ut,{children:[t(pt,{variant:"h5",gutterBottom:!0,children:"Sector Information"}),t("form",{children:n(J,{container:!0,spacing:2,children:[n(J,{item:!0,xs:12,sm:3,children:[t("label",{children:"Sector"}),n("select",{className:"form-control mb-3",value:o.sector_id,name:"sector_id",onChange:j,children:[t("option",{defaultValue:!0,children:"Select Sector"}),S.length>0?S.map(a=>t("option",{value:a.value,children:a.label},a.value)):t("option",{disabled:!0,children:"No Sector was found"})]})]}),n(J,{item:!0,xs:12,sm:3,children:[t("label",{children:"Categories"}),n("select",{className:"form-control mb-3",value:o.category_id,name:"category_id",onChange:W,children:[t("option",{defaultValue:!0,children:"Select Category"}),(T==null?void 0:T.length)>0?T.map(a=>t("option",{value:a.id,children:a.name},a.id)):t("option",{disabled:!0,children:"Select TaskModel type First"})]})]}),n(J,{item:!0,xs:12,sm:3,children:[t("label",{children:"Date"}),t("input",{type:"date",className:"form-control mb-3",name:"date",value:o.date,onChange:W})]}),n(J,{item:!0,xs:12,sm:3,children:[t("label",{children:"Expense Account"}),n("select",{className:"form-control mb-3",value:o.account_id,name:"account_id",onChange:W,children:[t("option",{defaultValue:!0,children:"Select Account"}),R.length>0?R.map(a=>n("option",{value:a.id,children:[a.bank_name," - ",a.account_number]},a.id)):t("option",{disabled:!0,children:"No account was found"})]})]})]})})]})}),n(st,{style:{marginTop:"20px"},children:[n(ut,{children:[t(pt,{variant:"h5",gutterBottom:!0,children:"Asset Details"}),t(Ot,{style:{padding:"0px"},children:n(Qt,{size:"small","aria-label":"asset information table",children:[t(Wt,{children:n(ht,{children:[t(C,{align:"center",children:t("b",{children:"Name"})}),t(C,{align:"center",children:t("b",{children:"Description"})}),t(C,{align:"center",children:t("b",{children:"Quantity"})}),t(C,{align:"center",children:t("b",{children:"Unit Price"})}),t(C,{align:"center",children:t("b",{children:"Total Price(with vat)"})}),t(C,{align:"center",children:t("b",{children:"Action"})})]})}),t(jt,{children:h&&(h==null?void 0:h.length)>0&&h.map((a,c)=>n(ht,{children:[t(C,{align:"left",children:t("input",{type:"text",placeholder:"i.g: Bed",className:"form-control",name:"name",value:a.name,onChange:s=>{w(s,c)}})}),t(C,{align:"left",children:t("input",{type:"text",placeholder:"i.g: Length: 200C CM",className:"form-control",name:"description",value:a.description,onChange:s=>{w(s,c)}})}),t(C,{align:"left",children:t("input",{type:"number",className:"form-control",name:"qty",step:1,min:1,value:a.qty,onChange:s=>{w(s,c),$(c)}})}),t(C,{align:"right",children:t("input",{type:"number",className:"form-control",name:"unit_price",min:1,value:a.unit_price,onChange:s=>{w(s,c),$(c)}})}),t(C,{align:"right",children:t("input",{type:"text",className:"form-control",name:"total_price",value:a.total_price,onChange:s=>w(s,c)})}),t(C,{align:"right",children:n(le,{variant:"contained","aria-label":"Basic button group",children:[t(Y,{color:"primary",onClick:rt,children:"+"}),c>0&&t(Y,{color:"error",onClick:()=>at(c),children:"-"})]})})]},"asset-"+c))}),(l==null?void 0:l.assets)&&t("p",{className:"error-message mt-2",children:l==null?void 0:l.assets[0]})]})})]}),t(Yt,{children:n("div",{className:"float-end",children:[o.id&&t(Y,{variant:"contained",sx:{m:2},onClick:a=>q(a,!1),children:"Update"}),!o.id&&n(tt,{children:[t(Y,{variant:"contained",sx:{m:2},onClick:a=>q(a,!0),children:"Create"}),t(Y,{variant:"contained",sx:{m:2},onClick:a=>q(a,!1),children:"Create & Exit"})]})]})})]})]})]})})}const ce=({showModal:r,handelCloseModal:e,title:o,data:i})=>t(tt,{children:n(P,{show:!0,centered:!0,onHide:e,className:"custom-modal modal-lg",children:[t(P.Header,{closeButton:!0,children:t(P.Title,{children:t("span",{children:o})})}),t(P.Body,{children:t("table",{className:"table table-bordered border-primary ",children:n("tbody",{children:[n("tr",{children:[n("td",{colSpan:4,children:["Sector:",t("strong",{children:i==null?void 0:i.sector_name})]}),n("td",{colSpan:2,children:["Purchase Date:",n("strong",{children:[" ",i==null?void 0:i.date]})]}),n("td",{colSpan:1,children:["Status:",n("strong",{children:[" ",(i==null?void 0:i.status)===1?"Active":"Paused"]})]})]}),n("tr",{children:[t("td",{rowSpan:3,children:"Balance"}),n("td",{colSpan:6,children:["Total Asset Amount:",n("strong",{children:[" ",i==null?void 0:i.total_price]})]})]}),t("tr",{children:n("td",{colSpan:6,children:["Damaged Asset's Amount:",n("strong",{children:[" ",i==null?void 0:i.total_damaged]})]})}),t("tr",{children:n("td",{colSpan:6,children:["Asset Used Amount:",t("strong",{children:i==null?void 0:i.total_used})]})}),t("tr",{children:t("td",{colSpan:7,className:"text-center",children:t("strong",{children:"Asset Information"})})}),n("tr",{children:[t("th",{children:"#"}),t("th",{children:"Name"}),t("th",{children:"Description"}),t("th",{children:"Quantity"}),t("th",{children:"Unit Price"}),t("th",{children:"Total Price"}),t("th",{children:"Current Stock"})]}),i==null?void 0:i.assets.map((l,F)=>n("tr",{children:[t("td",{children:F+1}),t("td",{children:l==null?void 0:l.name}),t("td",{children:l==null?void 0:l.description}),t("td",{children:l==null?void 0:l.qty}),t("td",{children:l==null?void 0:l.unit_price}),t("td",{children:l==null?void 0:l.total_price}),t("td",{children:(l==null?void 0:l.current_stock)??(l==null?void 0:l.qty)})]}))]})})}),t(P.Footer,{children:t("button",{className:"btn btn-primary",onClick:e,children:"Close"})})]})}),se=d.memo(ce);function ue(r){const{search:e,query:o,setQuery:i,resetFilterParameter:l,placeHolderTxt:F}=r;return t(tt,{children:t(Kt,{className:"p-3",style:{borderBottom:"1px solid"},children:n(Xt,{gap:3,children:[n(ct,{className:"g-3",children:[t(Z,{md:4,children:n(_.Group,{controlId:"search",children:[t(_.Label,{className:"custom-form-label",style:{marginBottom:"0px"},children:"Search"}),t(_.Control,{type:"text",size:"sm",value:o==null?void 0:o.searchTerm,onChange:m=>i({...o,searchTerm:m.target.value}),placeholder:F,style:{textTransform:"capitalize"}})]})}),t(Z,{md:2,children:n(_.Group,{controlId:"order",children:[t(_.Label,{className:"custom-form-label",style:{marginBottom:"0px"},children:"Order"}),n(_.Select,{size:"sm",value:o.orderBy,onChange:m=>i({...o,orderBy:m.target.value}),children:[t("option",{value:"ASC",children:"Ascending"}),t("option",{value:"DESC",children:"Descending"})]})]})}),t(Z,{md:2,children:n(_.Group,{controlId:"limit",children:[t(_.Label,{className:"custom-form-label",style:{marginBottom:"0px"},children:"Limit"}),n(_.Select,{size:"sm",value:o.limit,onChange:m=>i({...o,limit:m.target.value}),children:[t("option",{value:"",children:"Limit"}),t("option",{value:"10",children:"10"}),t("option",{value:"20",children:"20"}),t("option",{value:"50",children:"50"}),t("option",{value:"100",children:"100"}),t("option",{value:"500",children:"500"})]})]})})]}),t(ct,{className:"justify-content-end",children:t(Z,{md:4,className:"text-end",children:t(Vt,{variant:"warning",size:"sm",onClick:l,children:"Reset"})})})]})})})}const pe={id:null,date:"",sector_name:"",status:"",total_damaged:"",total_price:"",total_used:"",assets:[]},bt={searchTerm:"",orderBy:"DESC",limit:10};function Ve(){const[r,e]=d.useState(1),[o,i]=d.useState(0),[l,F]=d.useState(""),{applicationSettings:m,userRole:N,userPermission:h}=d.useContext(Rt),[b,R]=d.useState(bt),[k,S]=d.useState([]),[O,T]=d.useState(!1),[E,p]=d.useState(!1),[U,y]=d.useState(pe),[x,L]=d.useState(!1),[K,A]=d.useState(!1),[z,G]=d.useState(!0),[f,ot]=d.useState(!1),{num_data_per_page:nt,default_currency:Q}=m,W=[{id:"sector_name",label:"Sector Name",align:"left"},{id:"total_price",label:"Asset Amount",align:"right"},{id:"total_used",label:"Used Amount",align:"right"},{id:"total_damaged",label:"Damaged Amount",align:"right"},{id:"date",label:"Date",align:"right"},{id:"asset_status",label:"Status",align:"left"}],j=nt,w=Math.ceil(o/j),{data:$,isFetching:rt,isError:at}=Et({currentPage:r,pageSize:j,query:b},{skip:!j,refetchOnMountOrArgChange:O}),[q]=_t();d.useEffect(()=>{if(document.title="Manage Company Assets",$!=null&&$.data){const v=$==null?void 0:$.data.map((V,I)=>{var it=0,lt=0,dt=0;return V.assets.forEach(H=>{it+=Number(H.total_price),lt+=Number((H==null?void 0:H.total_used)??0),dt+=Number((H==null?void 0:H.total_damage)??0)}),{...V,total_price:Q+" "+it,total_used:Q+" "+lt,total_damaged:Q+" "+dt,asset_status:V.status===1?"Active":"Paused"}});S(v),i($.total),p(!1)}else p(!0);T(!1)},[$,r]);const a=k.filter(v=>v.sector_name.toLowerCase().includes(l.toLowerCase())),c=async v=>{Pt.fire({title:"Are you sure?",text:"You will not be able to recover the asset !",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, remove it!",cancelButtonText:"Cancel"}).then(async V=>{if(V.isConfirmed)try{const I=await q({id:v==null?void 0:v.id}).unwrap();et("success",I.message,I.description)}catch(I){et("error",I.data.message,I.data.description||"An error occurred.")}})},s=v=>{L(!0),y(v)},D=v=>{y(v),ot(!0)},u=()=>{ot(!1)},X=(v,V)=>{e(V)},vt=[{actionName:"Edit",type:"modal",route:"",actionFunction:s,permission:"asset_edit",textClass:"text-info"},{actionName:"View",type:"modal",route:"",actionFunction:D,permission:"asset_view",textClass:"text-warning"},{actionName:"Delete",type:"modal",route:"",actionFunction:c,permission:"asset_delete",textClass:"text-danger"}],Ct=()=>{L(!0)},Bt=()=>{L(!1),y({})},yt=()=>{R(bt),A(!K)},xt=()=>t(ue,{placeHolderTxt:"Search by name...",query:b,setQuery:R,resetFilterParameter:yt});return n("div",{children:[t(ft,{loaderVisible:E}),t(It,{cardTitle:"List of Company Assets",addBTN:{permission:Ht("asset_create"),txt:"Create New",icon:t(Ut,{icon:"eva:plus-fill"}),linkTo:"modal",link:Ct},paginations:{totalPages:w,totalCount:o,currentPage:r,handlePageChange:X},table:{size:"small",ariaLabel:"asset table",showIdColumn:N==="admin",tableColumns:W,tableBody:{loading:z,loadingColSpan:8,rows:a},actionButtons:vt},filter:xt,loading:rt,loaderRow:b==null?void 0:b.limit,loaderCol:8}),f&&t(se,{handelCloseModal:u,title:"Asset Details",data:U}),x&&t(de,{handelCloseModal:Bt,title:"Create New Asset",id:U.id})]})}export{Ve as default};
